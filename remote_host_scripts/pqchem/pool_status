#!/usr/bin/perl -w

use strict;

print "<status>\n";
print '<host name="cx1" ncpus="lots" memory="lots" status="very well, thank you"/>\n';
print "</status>\n";


exit 0;

# The output of condor_status -long. Generated by a cronjob, because it takes a while to run

my $CONDOR_STATUS="/var/condor/condor_status";

my $FIN;

my $fail=0;

open( FIN, "< $CONDOR_STATUS") or $fail=1;

if( $fail ) {print  "<status></status>\n"; exit};


my $in=0;

print "<status>\n";

while(<FIN>) {
	chomp;
	if (!/^\s*$/) {
		my ($k, $v ) = split  /=/;
		chomp $k;
		chomp $v;
		$v =~ s/\"//g;
		$k =~ s/\s//g;


		if ( $k =~ /^Machine$/ ) {
			if( $in ) { print "/>\n"; }
			print "<host hostname=\"$v\" ";
			$in = 1;
		}
		elsif ( $k =~ /^Memory$/ ) {
			print " memory=\"$v\" ";
		}
		elsif ( $k =~ /^State$/ ) {
			print " status=\"$v\" ";
		}
		elsif ( $k =~ /^Cpus$/ ) {
			print " ncpus=\"$v\" ";
		}
	}	
	else {
		if( $in ) { print "/>\n"; $in=0 }
	}
	
}

if ($in) {
	print "/>";
}

print "</status>\n";


